#1) Frroruting shell
vtysh

#2) Configuration mode
config t

#3) Hostname, disable ipv6 forwarding
hostname router-mgena-1
no ipv6 forwarding
service integrated-vtysh-config

#4) Setup interface eth0
interface eth0
ip address 10.1.1.1/30

#5) Setup interface eth1
interface eth1
ip address 10.1.1.5/30

#6) Setup interface eth2
interface eth2
ip address 10.1.1.9/30

#7) Setup interface lo
interface lo
ip address 1.1.1.1/32

# It's a good practice to set passive interfaces in OSPF for interfaces
# that are not directly connected to the network. We will not send hello
# packets because we have no neighbors on lo interface.
ip ospf passive

#8) Enable OSPF on all interfaces
router ospf
network 1.1.1.1/32 area 0
network 10.1.1.0/30 area 0
network 10.1.1.4/30 area 0
network 10.1.1.8/30 area 0

#9) Setup BGP
router bgp 65000
bgp router-id 1.1.1.1
no bgp default ipv4-unicast

#10) Configure BGP peer-group LEAFS
neighbor LEAFS peer-group
neighbor LEAFS remote-as 65000
neighbor LEAFS update-source lo

#11) Configure BGP neighbors in peer-group LEAFS
neighbor 1.1.1.2 peer-group LEAFS
neighbor 1.1.1.3 peer-group LEAFS
neighbor 1.1.1.4 peer-group LEAFS

#12) Enable EVPN on all interfaces
address-family l2vpn evpn
neighbor LEAFS activate
neighbor LEAFS route-reflector-client
exit-address-family

end
write